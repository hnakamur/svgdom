<html>
<head>
<title>svgdom - A SVG DOM manipulator which is easy to use for common tasks.</title>
<script src="../svgweb/src/svg.js" data-path="../svgweb/src/"></script>
<script src="svgdom.js"></script>
<script src="bezier.js"></script>
<script>
window.onload = function() {
  // build up a element tree.
  var s = svgdom.ElementWrapper.byId('mySVG');

  var controlPoints = [100,200, 200,210, 211,512, 400,200];

  var path1 = s.path(
    [
      ['M'].concat(controlPoints.slice(0, 2)),
      ['C'].concat(controlPoints.slice(2))
    ],
    { id: 'path1', stroke: '#f00', opacity: 0.5, 'stroke-width': 1 }
  );

  s.path(
    [
      ['M'].concat(controlPoints.slice(0, 2)),
      ['L'].concat(controlPoints.slice(2))
    ],
    { stroke: '#0f0' }
  );

  var bezier = new Bezier(Vector.fromFlatArray(controlPoints));
  bezier.divideToSegments();
  console.log('bezier');
  console.log(bezier);
  console.log('segmentCount=' + bezier.segments.length + ', curveLen=' + bezier.curveLength);
  console.log('path1.getTotalLength()=' + path1.element.getTotalLength());

  for (var i = 0, n = bezier.points.length; i < n; ++i) {
    var p = bezier.points[i];
    s.use({
      x: p.x,
      y: p.y,
      'xlink:href': '#point'
    });
  }

  xy = Vector.toFlatArray(bezier.points);
  s.path(
    [
      ['M'].concat(xy.slice(0, 2)),
      ['L'].concat(xy.slice(2))
    ],
    { stroke: '#00f', opacity: 0.2, 'stroke-width': 1 }
  );

  svgdom.ElementWrapper.unwrapAll();
}
</script>
</head>
<body>
  <script type="image/svg+xml">
    <svg id="mySVG" width="1200" height="1200" style="border: 1px solid black;">
      <defs>
        <circle id="point" r="1.5" fill="#0ff" stroke="none"/>
      </defs>
    </svg>
  </script>
</body>
</html>
